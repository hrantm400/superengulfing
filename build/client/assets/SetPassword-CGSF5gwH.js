import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{u as v,r as o}from"./index-QScjhSTK.js";import{u as j}from"./LocaleContext-83TzI_2y.js";import{u as P}from"./index-CbJBlSim.js";import{u as N,L as n}from"./components-CDq68o1-.js";const k="",E=()=>{const[x]=N(),h=v(),{localizePath:a}=j(),{t:s}=P(),l=x.get("token")||"",[i,w]=o.useState(""),[c,f]=o.useState(""),[m,u]=o.useState(!1),[d,r]=o.useState(null);o.useEffect(()=>{l||r("missingToken")},[l]);const b=async t=>{if(t.preventDefault(),r(null),i.length<6){r("passwordMin");return}if(i!==c){r("passwordsMatch");return}u(!0);try{const p=await fetch(`${k}/api/set-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:l,password:i})}),g=await p.json().catch(()=>({}));if(!p.ok){const y=(g.message||"").toLowerCase();r(y.includes("already used")?"linkUsed":"linkInvalid");return}h(a("/login"),{state:{message:s("setPassword.passwordSet")}})}catch{r("errorGeneric")}finally{u(!1)}};return e.jsxs("div",{className:"relative min-h-screen flex flex-col items-center justify-center px-4 sm:px-6 py-24",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",children:e.jsx("div",{className:"absolute top-1/4 left-1/2 w-[400px] h-[400px] bg-primary/5 rounded-full blur-[120px] -translate-x-1/2 -translate-y-1/2"})}),e.jsxs("div",{className:"relative z-10 w-full max-w-md animate-fade-in-up",children:[e.jsxs("div",{className:"rounded-card border border-border bg-surface/80 backdrop-blur-sm p-8 md:p-10 shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:s("setPassword.title")}),e.jsx("p",{className:"text-gray-400 text-sm mb-8",children:s("setPassword.subtitle")}),l?d==="linkUsed"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-amber-400 animate-scale-in",children:s("setPassword.linkUsed")}),e.jsx(n,{to:a("/login"),className:"inline-block bg-primary text-black font-bold py-2 px-4 rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:s("setPassword.goToLogin")})]}):d==="linkInvalid"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-red-400",children:s("setPassword.linkInvalid")}),e.jsxs("p",{className:"text-sm text-muted",children:[s("setPassword.alreadySetPart1"),e.jsx(n,{to:a("/login"),className:"text-primary hover:underline underline-offset-2",children:s("setPassword.logInLink")}),s("setPassword.alreadySetPart2"),e.jsx(n,{to:a("/course-access"),className:"text-primary hover:underline underline-offset-2",children:s("setPassword.accessPage")}),s("setPassword.alreadySetPart3")]})]}):e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"set-password",className:"block text-sm font-medium text-muted mb-2",children:s("setPassword.passwordLabel")}),e.jsx("input",{id:"set-password",type:"password",value:i,onChange:t=>w(t.target.value),placeholder:"••••••••",minLength:6,className:"w-full bg-background border border-border rounded-lg px-4 py-3 text-foreground placeholder-muted focus:border-primary focus:ring-2 focus:ring-primary/50 outline-none transition-all duration-300",autoComplete:"new-password"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"set-password-confirm",className:"block text-sm font-medium text-muted mb-2",children:s("setPassword.confirmLabel")}),e.jsx("input",{id:"set-password-confirm",type:"password",value:c,onChange:t=>f(t.target.value),placeholder:"••••••••",minLength:6,className:"w-full bg-background border border-border rounded-lg px-4 py-3 text-foreground placeholder-muted focus:border-primary focus:ring-2 focus:ring-primary/50 outline-none transition-all duration-300",autoComplete:"new-password"})]}),d&&e.jsx("p",{className:"text-sm text-red-400 animate-scale-in",children:s(`setPassword.${d}`)}),e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-primary hover:bg-primary/90 text-black font-bold py-3 px-4 rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300 disabled:opacity-50 disabled:hover:scale-100",children:s(m?"setPassword.setting":"setPassword.setButton")})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-red-400",children:s("setPassword.missingToken")}),e.jsx(n,{to:a("/course-access"),className:"text-primary hover:underline underline-offset-2",children:s("setPassword.requestAccess")})]})]}),e.jsx("p",{className:"text-center text-muted text-sm mt-6",children:e.jsx(n,{to:a("/login"),className:"text-primary hover:underline underline-offset-2 transition-colors duration-200",children:s("setPassword.backToLogin")})})]})]})};export{E as S};
