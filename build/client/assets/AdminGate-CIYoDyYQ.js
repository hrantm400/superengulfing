import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as u,R as Q,a as ls,u as os}from"./index-QScjhSTK.js";import{b as is}from"./api-c0T8i5BA.js";import{P as Ge}from"./plus-DXKeQuKl.js";import{B as pt}from"./book-open-DpnmxrYp.js";import{c as Ze}from"./createLucideIcon-CnELezcF.js";import{X as ds}from"./x-fvj0jzvG.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M10 12H3",key:"1ulcyk"}],["path",{d:"M10 19H3",key:"108z41"}],["path",{d:"M15 12.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997a1 1 0 0 1-1.517-.86z",key:"ms4nik"}]],us=Ze("list-video",cs);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],hs=Ze("pencil",ms);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],bt=Ze("trash-2",xs),gt="",Le="adminSession",Nt=u.createContext(void 0);function ft(){try{const x=localStorage.getItem(Le);if(!x)return null;const c=JSON.parse(x);return!c.token||!c.expiresAt?null:new Date(c.expiresAt)<=new Date?(localStorage.removeItem(Le),null):c}catch{return null}}function ps(x,c){localStorage.setItem(Le,JSON.stringify({token:x,expiresAt:c}))}function yt(){localStorage.removeItem(Le)}function Os({children:x}){const[c,n]=u.useState(ft),b=u.useMemo(()=>!(c!=null&&c.token)||!(c!=null&&c.expiresAt)?!1:new Date(c.expiresAt)>new Date,[c]),h=u.useCallback(async r=>{try{const s=await fetch(`${gt}/api/admin-auth/request-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r.trim()})}),l=await s.json().catch(()=>({}));return s.ok?{success:!0,emailMasked:l.emailMasked,setupRequired:l.setupRequired,otpauthUrl:l.otpauthUrl}:{success:!1,error:l.error||"Invalid secret password"}}catch{return{success:!1,error:"Request failed"}}},[]),f=u.useCallback(async(r,s,l,d)=>{try{const g=await fetch(`${gt}/api/admin-auth/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.trim().toLowerCase(),code:s.trim(),rememberMe:!!l,rememberDuration:d||"1h"})}),m=await g.json().catch(()=>({}));return g.ok?(ps(m.token,m.expiresAt),n({token:m.token,expiresAt:m.expiresAt}),{success:!0}):{success:!1,error:m.error||"Invalid or expired code"}}catch{return{success:!1,error:"Verification failed"}}},[]),C=u.useCallback(()=>{yt(),n(null)},[]),S=u.useCallback(async(r,s={})=>{const l=ft(),d=l==null?void 0:l.token,g=new Headers(s.headers);d&&g.set("Authorization",`Bearer ${d}`);const m=await fetch(r,{...s,headers:g});return m.status===401&&(yt(),n(null)),m},[]),a=u.useMemo(()=>({token:(c==null?void 0:c.token)??null,expiresAt:(c==null?void 0:c.expiresAt)??null,isValid:b,requestCode:h,verify:f,logout:C,fetchWithAdminAuth:S}),[c,b,h,f,C,S]);return e.jsx(Nt.Provider,{value:a,children:x})}function et(){const x=u.useContext(Nt);if(x===void 0)throw new Error("useAdminAuth must be used within AdminAuthProvider");return x}var bs=Object.defineProperty,Fe=Object.getOwnPropertySymbols,wt=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,jt=(x,c,n)=>c in x?bs(x,c,{enumerable:!0,configurable:!0,writable:!0,value:n}):x[c]=n,Xe=(x,c)=>{for(var n in c||(c={}))wt.call(c,n)&&jt(x,n,c[n]);if(Fe)for(var n of Fe(c))Ct.call(c,n)&&jt(x,n,c[n]);return x},Ke=(x,c)=>{var n={};for(var b in x)wt.call(x,b)&&c.indexOf(b)<0&&(n[b]=x[b]);if(x!=null&&Fe)for(var b of Fe(x))c.indexOf(b)<0&&Ct.call(x,b)&&(n[b]=x[b]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var be;(x=>{const c=class E{constructor(a,r,s,l){if(this.version=a,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],a<E.MIN_VERSION||a>E.MAX_VERSION)throw new RangeError("Version value out of range");if(l<-1||l>7)throw new RangeError("Mask value out of range");this.size=a*4+17;let d=[];for(let m=0;m<this.size;m++)d.push(!1);for(let m=0;m<this.size;m++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(s);if(this.drawCodewords(g),l==-1){let m=1e9;for(let N=0;N<8;N++){this.applyMask(N),this.drawFormatBits(N);const p=this.getPenaltyScore();p<m&&(l=N,m=p),this.applyMask(N)}}h(0<=l&&l<=7),this.mask=l,this.applyMask(l),this.drawFormatBits(l),this.isFunction=[]}static encodeText(a,r){const s=x.QrSegment.makeSegments(a);return E.encodeSegments(s,r)}static encodeBinary(a,r){const s=x.QrSegment.makeBytes(a);return E.encodeSegments([s],r)}static encodeSegments(a,r,s=1,l=40,d=-1,g=!0){if(!(E.MIN_VERSION<=s&&s<=l&&l<=E.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");let m,N;for(m=s;;m++){const w=E.getNumDataCodewords(m,r)*8,$=C.getTotalBits(a,m);if($<=w){N=$;break}if(m>=l)throw new RangeError("Data too long")}for(const w of[E.Ecc.MEDIUM,E.Ecc.QUARTILE,E.Ecc.HIGH])g&&N<=E.getNumDataCodewords(m,w)*8&&(r=w);let p=[];for(const w of a){n(w.mode.modeBits,4,p),n(w.numChars,w.mode.numCharCountBits(m),p);for(const $ of w.getData())p.push($)}h(p.length==N);const R=E.getNumDataCodewords(m,r)*8;h(p.length<=R),n(0,Math.min(4,R-p.length),p),n(0,(8-p.length%8)%8,p),h(p.length%8==0);for(let w=236;p.length<R;w^=253)n(w,8,p);let k=[];for(;k.length*8<p.length;)k.push(0);return p.forEach((w,$)=>k[$>>>3]|=w<<7-($&7)),new E(m,r,k,d)}getModule(a,r){return 0<=a&&a<this.size&&0<=r&&r<this.size&&this.modules[r][a]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const a=this.getAlignmentPatternPositions(),r=a.length;for(let s=0;s<r;s++)for(let l=0;l<r;l++)s==0&&l==0||s==0&&l==r-1||s==r-1&&l==0||this.drawAlignmentPattern(a[s],a[l]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(a){const r=this.errorCorrectionLevel.formatBits<<3|a;let s=r;for(let d=0;d<10;d++)s=s<<1^(s>>>9)*1335;const l=(r<<10|s)^21522;h(l>>>15==0);for(let d=0;d<=5;d++)this.setFunctionModule(8,d,b(l,d));this.setFunctionModule(8,7,b(l,6)),this.setFunctionModule(8,8,b(l,7)),this.setFunctionModule(7,8,b(l,8));for(let d=9;d<15;d++)this.setFunctionModule(14-d,8,b(l,d));for(let d=0;d<8;d++)this.setFunctionModule(this.size-1-d,8,b(l,d));for(let d=8;d<15;d++)this.setFunctionModule(8,this.size-15+d,b(l,d));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let a=this.version;for(let s=0;s<12;s++)a=a<<1^(a>>>11)*7973;const r=this.version<<12|a;h(r>>>18==0);for(let s=0;s<18;s++){const l=b(r,s),d=this.size-11+s%3,g=Math.floor(s/3);this.setFunctionModule(d,g,l),this.setFunctionModule(g,d,l)}}drawFinderPattern(a,r){for(let s=-4;s<=4;s++)for(let l=-4;l<=4;l++){const d=Math.max(Math.abs(l),Math.abs(s)),g=a+l,m=r+s;0<=g&&g<this.size&&0<=m&&m<this.size&&this.setFunctionModule(g,m,d!=2&&d!=4)}}drawAlignmentPattern(a,r){for(let s=-2;s<=2;s++)for(let l=-2;l<=2;l++)this.setFunctionModule(a+l,r+s,Math.max(Math.abs(l),Math.abs(s))!=1)}setFunctionModule(a,r,s){this.modules[r][a]=s,this.isFunction[r][a]=!0}addEccAndInterleave(a){const r=this.version,s=this.errorCorrectionLevel;if(a.length!=E.getNumDataCodewords(r,s))throw new RangeError("Invalid argument");const l=E.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][r],d=E.ECC_CODEWORDS_PER_BLOCK[s.ordinal][r],g=Math.floor(E.getNumRawDataModules(r)/8),m=l-g%l,N=Math.floor(g/l);let p=[];const R=E.reedSolomonComputeDivisor(d);for(let w=0,$=0;w<l;w++){let O=a.slice($,$+N-d+(w<m?0:1));$+=O.length;const P=E.reedSolomonComputeRemainder(O,R);w<m&&O.push(0),p.push(O.concat(P))}let k=[];for(let w=0;w<p[0].length;w++)p.forEach(($,O)=>{(w!=N-d||O>=m)&&k.push($[w])});return h(k.length==g),k}drawCodewords(a){if(a.length!=Math.floor(E.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let l=0;l<this.size;l++)for(let d=0;d<2;d++){const g=s-d,N=(s+1&2)==0?this.size-1-l:l;!this.isFunction[N][g]&&r<a.length*8&&(this.modules[N][g]=b(a[r>>>3],7-(r&7)),r++)}}h(r==a.length*8)}applyMask(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let s=0;s<this.size;s++){let l;switch(a){case 0:l=(s+r)%2==0;break;case 1:l=r%2==0;break;case 2:l=s%3==0;break;case 3:l=(s+r)%3==0;break;case 4:l=(Math.floor(s/3)+Math.floor(r/2))%2==0;break;case 5:l=s*r%2+s*r%3==0;break;case 6:l=(s*r%2+s*r%3)%2==0;break;case 7:l=((s+r)%2+s*r%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[r][s]&&l&&(this.modules[r][s]=!this.modules[r][s])}}getPenaltyScore(){let a=0;for(let d=0;d<this.size;d++){let g=!1,m=0,N=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[d][p]==g?(m++,m==5?a+=E.PENALTY_N1:m>5&&a++):(this.finderPenaltyAddHistory(m,N),g||(a+=this.finderPenaltyCountPatterns(N)*E.PENALTY_N3),g=this.modules[d][p],m=1);a+=this.finderPenaltyTerminateAndCount(g,m,N)*E.PENALTY_N3}for(let d=0;d<this.size;d++){let g=!1,m=0,N=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[p][d]==g?(m++,m==5?a+=E.PENALTY_N1:m>5&&a++):(this.finderPenaltyAddHistory(m,N),g||(a+=this.finderPenaltyCountPatterns(N)*E.PENALTY_N3),g=this.modules[p][d],m=1);a+=this.finderPenaltyTerminateAndCount(g,m,N)*E.PENALTY_N3}for(let d=0;d<this.size-1;d++)for(let g=0;g<this.size-1;g++){const m=this.modules[d][g];m==this.modules[d][g+1]&&m==this.modules[d+1][g]&&m==this.modules[d+1][g+1]&&(a+=E.PENALTY_N2)}let r=0;for(const d of this.modules)r=d.reduce((g,m)=>g+(m?1:0),r);const s=this.size*this.size,l=Math.ceil(Math.abs(r*20-s*10)/s)-1;return h(0<=l&&l<=9),a+=l*E.PENALTY_N4,h(0<=a&&a<=2568888),a}getAlignmentPatternPositions(){if(this.version==1)return[];{const a=Math.floor(this.version/7)+2,r=this.version==32?26:Math.ceil((this.version*4+4)/(a*2-2))*2;let s=[6];for(let l=this.size-7;s.length<a;l-=r)s.splice(1,0,l);return s}}static getNumRawDataModules(a){if(a<E.MIN_VERSION||a>E.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*a+128)*a+64;if(a>=2){const s=Math.floor(a/7)+2;r-=(25*s-10)*s-55,a>=7&&(r-=36)}return h(208<=r&&r<=29648),r}static getNumDataCodewords(a,r){return Math.floor(E.getNumRawDataModules(a)/8)-E.ECC_CODEWORDS_PER_BLOCK[r.ordinal][a]*E.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][a]}static reedSolomonComputeDivisor(a){if(a<1||a>255)throw new RangeError("Degree out of range");let r=[];for(let l=0;l<a-1;l++)r.push(0);r.push(1);let s=1;for(let l=0;l<a;l++){for(let d=0;d<r.length;d++)r[d]=E.reedSolomonMultiply(r[d],s),d+1<r.length&&(r[d]^=r[d+1]);s=E.reedSolomonMultiply(s,2)}return r}static reedSolomonComputeRemainder(a,r){let s=r.map(l=>0);for(const l of a){const d=l^s.shift();s.push(0),r.forEach((g,m)=>s[m]^=E.reedSolomonMultiply(g,d))}return s}static reedSolomonMultiply(a,r){if(a>>>8||r>>>8)throw new RangeError("Byte out of range");let s=0;for(let l=7;l>=0;l--)s=s<<1^(s>>>7)*285,s^=(r>>>l&1)*a;return h(s>>>8==0),s}finderPenaltyCountPatterns(a){const r=a[1];h(r<=this.size*3);const s=r>0&&a[2]==r&&a[3]==r*3&&a[4]==r&&a[5]==r;return(s&&a[0]>=r*4&&a[6]>=r?1:0)+(s&&a[6]>=r*4&&a[0]>=r?1:0)}finderPenaltyTerminateAndCount(a,r,s){return a&&(this.finderPenaltyAddHistory(r,s),r=0),r+=this.size,this.finderPenaltyAddHistory(r,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(a,r){r[0]==0&&(a+=this.size),r.pop(),r.unshift(a)}};c.MIN_VERSION=1,c.MAX_VERSION=40,c.PENALTY_N1=3,c.PENALTY_N2=3,c.PENALTY_N3=40,c.PENALTY_N4=10,c.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],c.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],x.QrCode=c;function n(S,a,r){if(a<0||a>31||S>>>a)throw new RangeError("Value out of range");for(let s=a-1;s>=0;s--)r.push(S>>>s&1)}function b(S,a){return(S>>>a&1)!=0}function h(S){if(!S)throw new Error("Assertion error")}const f=class D{constructor(a,r,s){if(this.mode=a,this.numChars=r,this.bitData=s,r<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(a){let r=[];for(const s of a)n(s,8,r);return new D(D.Mode.BYTE,a.length,r)}static makeNumeric(a){if(!D.isNumeric(a))throw new RangeError("String contains non-numeric characters");let r=[];for(let s=0;s<a.length;){const l=Math.min(a.length-s,3);n(parseInt(a.substring(s,s+l),10),l*3+1,r),s+=l}return new D(D.Mode.NUMERIC,a.length,r)}static makeAlphanumeric(a){if(!D.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r=[],s;for(s=0;s+2<=a.length;s+=2){let l=D.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s))*45;l+=D.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s+1)),n(l,11,r)}return s<a.length&&n(D.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s)),6,r),new D(D.Mode.ALPHANUMERIC,a.length,r)}static makeSegments(a){return a==""?[]:D.isNumeric(a)?[D.makeNumeric(a)]:D.isAlphanumeric(a)?[D.makeAlphanumeric(a)]:[D.makeBytes(D.toUtf8ByteArray(a))]}static makeEci(a){let r=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)n(a,8,r);else if(a<16384)n(2,2,r),n(a,14,r);else if(a<1e6)n(6,3,r),n(a,21,r);else throw new RangeError("ECI assignment value out of range");return new D(D.Mode.ECI,0,r)}static isNumeric(a){return D.NUMERIC_REGEX.test(a)}static isAlphanumeric(a){return D.ALPHANUMERIC_REGEX.test(a)}getData(){return this.bitData.slice()}static getTotalBits(a,r){let s=0;for(const l of a){const d=l.mode.numCharCountBits(r);if(l.numChars>=1<<d)return 1/0;s+=4+d+l.bitData.length}return s}static toUtf8ByteArray(a){a=encodeURI(a);let r=[];for(let s=0;s<a.length;s++)a.charAt(s)!="%"?r.push(a.charCodeAt(s)):(r.push(parseInt(a.substring(s+1,s+3),16)),s+=2);return r}};f.NUMERIC_REGEX=/^[0-9]*$/,f.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,f.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let C=f;x.QrSegment=f})(be||(be={}));(x=>{(c=>{const n=class{constructor(h,f){this.ordinal=h,this.formatBits=f}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),c.Ecc=n})(x.QrCode||(x.QrCode={}))})(be||(be={}));(x=>{(c=>{const n=class{constructor(h,f){this.modeBits=h,this.numBitsCharCount=f}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),c.Mode=n})(x.QrSegment||(x.QrSegment={}))})(be||(be={}));var ve=be;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var gs={L:ve.QrCode.Ecc.LOW,M:ve.QrCode.Ecc.MEDIUM,Q:ve.QrCode.Ecc.QUARTILE,H:ve.QrCode.Ecc.HIGH},St=128,kt="L",Et="#FFFFFF",_t="#000000",At=!1,Tt=1,fs=4,ys=0,js=.1;function Rt(x,c=0){const n=[];return x.forEach(function(b,h){let f=null;b.forEach(function(C,S){if(!C&&f!==null){n.push(`M${f+c} ${h+c}h${S-f}v1H${f+c}z`),f=null;return}if(S===b.length-1){if(!C)return;f===null?n.push(`M${S+c},${h+c} h1v1H${S+c}z`):n.push(`M${f+c},${h+c} h${S+1-f}v1H${f+c}z`);return}C&&f===null&&(f=S)})}),n.join("")}function $t(x,c){return x.slice().map((n,b)=>b<c.y||b>=c.y+c.h?n:n.map((h,f)=>f<c.x||f>=c.x+c.w?h:!1))}function vs(x,c,n,b){if(b==null)return null;const h=x.length+n*2,f=Math.floor(c*js),C=h/c,S=(b.width||f)*C,a=(b.height||f)*C,r=b.x==null?x.length/2-S/2:b.x*C,s=b.y==null?x.length/2-a/2:b.y*C,l=b.opacity==null?1:b.opacity;let d=null;if(b.excavate){let m=Math.floor(r),N=Math.floor(s),p=Math.ceil(S+r-m),R=Math.ceil(a+s-N);d={x:m,y:N,w:p,h:R}}const g=b.crossOrigin;return{x:r,y:s,h:a,w:S,excavation:d,opacity:l,crossOrigin:g}}function Ns(x,c){return c!=null?Math.max(Math.floor(c),0):x?fs:ys}function Pt({value:x,level:c,minVersion:n,includeMargin:b,marginSize:h,imageSettings:f,size:C,boostLevel:S}){let a=Q.useMemo(()=>{const m=(Array.isArray(x)?x:[x]).reduce((N,p)=>(N.push(...ve.QrSegment.makeSegments(p)),N),[]);return ve.QrCode.encodeSegments(m,gs[c],n,void 0,void 0,S)},[x,c,n,S]);const{cells:r,margin:s,numCells:l,calculatedImageSettings:d}=Q.useMemo(()=>{let g=a.getModules();const m=Ns(b,h),N=g.length+m*2,p=vs(g,C,m,f);return{cells:g,margin:m,numCells:N,calculatedImageSettings:p}},[a,C,f,b,h]);return{qrcode:a,margin:s,cells:r,numCells:l,calculatedImageSettings:d}}var ws=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),Cs=Q.forwardRef(function(c,n){const b=c,{value:h,size:f=St,level:C=kt,bgColor:S=Et,fgColor:a=_t,includeMargin:r=At,minVersion:s=Tt,boostLevel:l,marginSize:d,imageSettings:g}=b,N=Ke(b,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:p}=N,R=Ke(N,["style"]),k=g==null?void 0:g.src,w=Q.useRef(null),$=Q.useRef(null),O=Q.useCallback(J=>{w.current=J,typeof n=="function"?n(J):n&&(n.current=J)},[n]),[P,H]=Q.useState(!1),{margin:F,cells:U,numCells:ae,calculatedImageSettings:B}=Pt({value:h,level:C,minVersion:s,boostLevel:l,includeMargin:r,marginSize:d,imageSettings:g,size:f});Q.useEffect(()=>{if(w.current!=null){const J=w.current,Y=J.getContext("2d");if(!Y)return;let _=U;const L=$.current,le=B!=null&&L!==null&&L.complete&&L.naturalHeight!==0&&L.naturalWidth!==0;le&&B.excavation!=null&&(_=$t(U,B.excavation));const oe=window.devicePixelRatio||1;J.height=J.width=f*oe;const ie=f/ae*oe;Y.scale(ie,ie),Y.fillStyle=S,Y.fillRect(0,0,ae,ae),Y.fillStyle=a,ws?Y.fill(new Path2D(Rt(_,F))):U.forEach(function(ce,ue){ce.forEach(function(o,z){o&&Y.fillRect(z+F,ue+F,1,1)})}),B&&(Y.globalAlpha=B.opacity),le&&Y.drawImage(L,B.x+F,B.y+F,B.w,B.h)}}),Q.useEffect(()=>{H(!1)},[k]);const Z=Xe({height:f,width:f},p);let re=null;return k!=null&&(re=Q.createElement("img",{src:k,key:k,style:{display:"none"},onLoad:()=>{H(!0)},ref:$,crossOrigin:B==null?void 0:B.crossOrigin})),Q.createElement(Q.Fragment,null,Q.createElement("canvas",Xe({style:Z,height:f,width:f,ref:O,role:"img"},R)),re)});Cs.displayName="QRCodeCanvas";var Mt=Q.forwardRef(function(c,n){const b=c,{value:h,size:f=St,level:C=kt,bgColor:S=Et,fgColor:a=_t,includeMargin:r=At,minVersion:s=Tt,boostLevel:l,title:d,marginSize:g,imageSettings:m}=b,N=Ke(b,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:p,cells:R,numCells:k,calculatedImageSettings:w}=Pt({value:h,level:C,minVersion:s,boostLevel:l,includeMargin:r,marginSize:g,imageSettings:m,size:f});let $=R,O=null;m!=null&&w!=null&&(w.excavation!=null&&($=$t(R,w.excavation)),O=Q.createElement("image",{href:m.src,height:w.h,width:w.w,x:w.x+p,y:w.y+p,preserveAspectRatio:"none",opacity:w.opacity,crossOrigin:w.crossOrigin}));const P=Rt($,p);return Q.createElement("svg",Xe({height:f,width:f,viewBox:`0 0 ${k} ${k}`,ref:n,role:"img"},N),!!d&&Q.createElement("title",null,d),Q.createElement("path",{fill:S,d:`M0,0 h${k}v${k}H0z`,shapeRendering:"crispEdges"}),Q.createElement("path",{fill:a,d:P,shapeRendering:"crispEdges"}),O)});Mt.displayName="QRCodeSVG";const G=is(),Ss=({setMessage:x})=>{const{fetchWithAdminAuth:c}=et(),[n,b]=u.useState([]),[h,f]=u.useState({title:"",description:"",image_url:""}),[C,S]=u.useState(null),[a,r]=u.useState(!1),[s,l]=u.useState(null),[d,g]=u.useState(""),[m,N]=u.useState([]),[p,R]=u.useState({title:"",description:"",position:0,video_type:"youtube",video_url:""}),[k,w]=u.useState(null),[$,O]=u.useState(!1),[P,H]=u.useState([]),[F,U]=u.useState({title:"",url:""});u.useEffect(()=>{c(`${G}/api/courses`).then(o=>o.json()).then(o=>b(o.courses||[])).catch(()=>b([]))},[]),u.useEffect(()=>{s!=null?c(`${G}/api/courses/${s}/lessons`).then(o=>o.json()).then(o=>N(o.lessons||[])).catch(()=>N([])):N([])},[s]),u.useEffect(()=>{k!=null&&$?c(`${G}/api/lessons/${k}/resources`,{credentials:"include"}).then(o=>o.json()).then(o=>H(o.resources||[])).catch(()=>H([])):(H([]),U({title:"",url:""}))},[k,$]);const ae=n.reduce((o,z)=>o+parseInt(z.lesson_count||"0",10),0),B=()=>{f({title:"",description:"",image_url:""}),S(null),r(!0)},Z=o=>{f({title:o.title,description:o.description||"",image_url:o.image_url||""}),S(o.id),r(!0)},re=async()=>{if(!h.title.trim()){x("Title required");return}try{C?(await c(`${G}/api/courses/${C}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:h.title.trim(),description:h.description.trim()||null,image_url:h.image_url.trim()||null})}),x("Course updated")):(await c(`${G}/api/courses`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:h.title.trim(),description:h.description.trim()||null,image_url:h.image_url.trim()||null})}),x("Course created")),r(!1),c(`${G}/api/courses`).then(o=>o.json()).then(o=>b(o.courses||[]))}catch{x("Failed to save course")}},J=async(o,z)=>{if(confirm(`Delete course "${z}" and all its lessons?`))try{await c(`${G}/api/courses/${o}`,{method:"DELETE"}),x("Course deleted"),b(ee=>ee.filter(X=>X.id!==o)),s===o&&l(null)}catch{x("Failed to delete")}},Y=o=>{l(o.id),g(o.title),w(null),R({title:"",description:"",position:m.length,video_type:"youtube",video_url:""}),O(!1)},_=()=>{R({title:"",description:"",position:m.length,video_type:"youtube",video_url:""}),w(null),H([]),U({title:"",url:""}),O(!0)},L=o=>{U({title:"",url:""}),R({title:o.title,description:o.description||"",position:o.position,video_type:o.video_type,video_url:o.video_url}),w(o.id),O(!0)},le=async()=>{if(!p.title.trim()||!p.video_url.trim()){x("Title and video URL required");return}if(s!=null)try{k?(await c(`${G}/api/lessons/${k}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:p.title.trim(),description:p.description.trim()||null,position:p.position,video_type:p.video_type,video_url:p.video_url.trim()})}),x("Lesson updated")):(await c(`${G}/api/courses/${s}/lessons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:p.title.trim(),description:p.description.trim()||null,position:p.position,video_type:p.video_type,video_url:p.video_url.trim()})}),x("Lesson added")),O(!1),c(`${G}/api/courses/${s}/lessons`).then(o=>o.json()).then(o=>{N(o.lessons||[])}),c(`${G}/api/courses`).then(o=>o.json()).then(o=>b(o.courses||[]))}catch{x("Failed to save lesson")}},oe=async o=>{if(confirm(`Delete lesson "${o.title}"?`))try{await c(`${G}/api/lessons/${o.id}`,{method:"DELETE"}),x("Lesson deleted"),N(z=>z.filter(ee=>ee.id!==o.id)),c(`${G}/api/courses`).then(z=>z.json()).then(z=>b(z.courses||[]))}catch{x("Failed to delete lesson")}},ie=async()=>{if(!k||!F.title.trim()||!F.url.trim()){x("Title and URL required");return}try{const o=await c(`${G}/api/lessons/${k}/resources`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:F.title.trim(),url:F.url.trim()}),credentials:"include"}),z=await o.json().catch(()=>({}));if(!o.ok){x(z.error||`Failed to add resource (${o.status})`);return}U({title:"",url:""});const X=await(await c(`${G}/api/lessons/${k}/resources`,{credentials:"include"})).json();H(X.resources||[]),x("Resource added")}catch{x("Failed to add resource")}},ce=async o=>{try{if(!(await c(`${G}/api/lesson-resources/${o}`,{method:"DELETE",credentials:"include"})).ok)return x("Failed to remove resource");H(ee=>ee.filter(X=>X.id!==o)),x("Resource removed")}catch{x("Failed to remove resource")}},ue=o=>new Date(o).toLocaleDateString();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Courses"}),e.jsxs("p",{className:"text-muted text-sm mt-1",children:[n.length," courses · ",ae," lessons"]})]}),e.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-4 py-2.5 rounded-xl bg-primary text-black font-bold text-sm hover:bg-primary-glow transition-colors shadow-glow-primary-sm",children:[e.jsx(Ge,{className:"w-4 h-4"})," Add course"]})]}),e.jsxs("div",{className:"bg-surface rounded-card border border-border overflow-hidden shadow-card mb-8",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceElevated",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Preview"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Lessons"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>e.jsxs("tr",{className:"hover:bg-surfaceElevated/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"w-14 h-10 rounded-lg bg-surfaceElevated overflow-hidden shrink-0",children:o.image_url?e.jsx("img",{src:o.image_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-muted"})})})}),e.jsx("td",{className:"px-6 py-4 font-medium text-foreground",children:o.title}),e.jsx("td",{className:"px-6 py-4 text-muted",children:o.lesson_count??0}),e.jsx("td",{className:"px-6 py-4 text-muted text-sm",children:ue(o.created_at)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("button",{onClick:()=>Y(o),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-surfaceElevated hover:bg-surface/80 text-foreground text-sm font-medium transition-colors",children:[e.jsx(us,{className:"w-3.5 h-3.5"})," Lessons"]}),e.jsxs("button",{onClick:()=>Z(o),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-primary/20 hover:bg-primary/30 text-primary text-sm font-medium transition-colors",children:[e.jsx(hs,{className:"w-3.5 h-3.5"})," Edit"]}),e.jsxs("button",{onClick:()=>J(o.id,o.title),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 text-sm font-medium transition-colors",children:[e.jsx(bt,{className:"w-3.5 h-3.5"})," Delete"]})]})})]},o.id))})]})}),n.length===0&&e.jsxs("div",{className:"p-12 text-center text-muted",children:[e.jsx(pt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:'No courses yet. Click "Add course" to create one.'})]})]}),s!=null&&e.jsxs("div",{className:"bg-surface rounded-card border border-border p-6 shadow-card mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-foreground",children:["Lessons for ",d]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:_,className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-primary text-black font-bold text-sm hover:bg-primary-glow transition-colors",children:[e.jsx(Ge,{className:"w-4 h-4"})," Add lesson"]}),e.jsxs("button",{onClick:()=>l(null),className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-surfaceElevated hover:bg-surface/80 text-foreground text-sm font-medium transition-colors",children:[e.jsx(ds,{className:"w-4 h-4"})," Close"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceElevated",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"#"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Video"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:m.map(o=>e.jsxs("tr",{className:"hover:bg-surfaceElevated/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-muted font-mono",children:o.position}),e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:o.title}),e.jsxs("td",{className:"px-4 py-3 text-muted text-sm truncate max-w-[220px]",title:o.video_url,children:[o.video_type,": ",o.video_url.length>50?o.video_url.slice(0,50)+"…":o.video_url]}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsx("button",{onClick:()=>L(o),className:"text-primary hover:underline text-sm font-medium mr-3",children:"Edit"}),e.jsx("button",{onClick:()=>oe(o),className:"text-red-400 hover:underline text-sm font-medium",children:"Delete"})]})]},o.id))})]})}),m.length===0&&!$&&e.jsx("p",{className:"p-6 text-center text-muted text-sm",children:'No lessons. Click "Add lesson" to add one.'})]}),a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>r(!1),children:e.jsxs("div",{className:"bg-surface rounded-card border border-border shadow-2xl w-full max-w-md p-6",onClick:o=>o.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-4",children:C?"Edit course":"Add course"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:h.title,onChange:o=>f({...h,title:o.target.value}),placeholder:"Course title",className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),e.jsx("textarea",{value:h.description,onChange:o=>f({...h,description:o.target.value}),placeholder:"Optional description",rows:3,className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Image URL"}),e.jsx("input",{type:"text",value:h.image_url,onChange:o=>f({...h,image_url:o.target.value}),placeholder:"https://...",className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:re,className:"flex-1 px-4 py-2.5 rounded-xl bg-primary text-black font-bold hover:bg-primary-glow transition-colors",children:"Save"}),e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2.5 rounded-xl bg-surfaceElevated hover:bg-surface/80 text-foreground font-medium transition-colors",children:"Cancel"})]})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>O(!1),children:e.jsxs("div",{className:"bg-surface rounded-card border border-border shadow-2xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto",onClick:o=>o.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-4",children:k?"Edit lesson":"Add lesson"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:p.title,onChange:o=>R({...p,title:o.target.value}),placeholder:"Lesson title",className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),e.jsx("input",{type:"text",value:p.description,onChange:o=>R({...p,description:o.target.value}),placeholder:"Optional",className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Position"}),e.jsx("input",{type:"number",min:0,value:p.position,onChange:o=>R({...p,position:parseInt(o.target.value,10)||0}),className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Video type *"}),e.jsxs("select",{value:p.video_type,onChange:o=>R({...p,video_type:o.target.value}),className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"youtube",children:"YouTube"}),e.jsx("option",{value:"wistia",children:"Wistia"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Video URL *"}),e.jsx("input",{type:"url",value:p.video_url,onChange:o=>R({...p,video_url:o.target.value}),placeholder:"https://youtube.com/watch?v=... or https://fast.wistia.net/embed/iframe/... or https://*.wistia.com/medias/...",className:"w-full bg-background border border-border rounded-xl px-4 py-2.5 text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"})]}),k!=null&&e.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-bold text-foreground mb-3",children:"Lesson Resources"}),P.length>0&&e.jsx("ul",{className:"space-y-2 mb-4",children:P.map(o=>e.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-lg bg-surfaceElevated border border-border",children:[e.jsx("span",{className:"flex-1 min-w-0 text-sm text-foreground truncate",title:o.url,children:o.title}),e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline shrink-0",children:"Open"}),e.jsx("button",{type:"button",onClick:()=>ce(o.id),className:"p-1 rounded text-red-400 hover:bg-red-500/10 shrink-0",title:"Remove",children:e.jsx(bt,{className:"w-3.5 h-3.5"})})]},o.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"text",value:F.title,onChange:o=>U({...F,title:o.target.value}),placeholder:"Title",className:"flex-1 min-w-0 bg-background border border-border rounded-xl px-3 py-2 text-sm text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"}),e.jsx("input",{type:"url",value:F.url,onChange:o=>U({...F,url:o.target.value}),placeholder:"https://...",className:"flex-1 min-w-0 bg-background border border-border rounded-xl px-3 py-2 text-sm text-foreground placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"}),e.jsxs("button",{type:"button",onClick:ie,className:"inline-flex items-center justify-center gap-1 px-3 py-2 rounded-xl bg-primary/20 hover:bg-primary/30 text-primary text-sm font-medium transition-colors shrink-0",children:[e.jsx(Ge,{className:"w-4 h-4"})," Add"]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:le,className:"flex-1 px-4 py-2.5 rounded-xl bg-primary text-black font-bold hover:bg-primary-glow transition-colors",children:"Save"}),e.jsx("button",{onClick:()=>O(!1),className:"px-4 py-2.5 rounded-xl bg-surfaceElevated hover:bg-surface/80 text-foreground font-medium transition-colors",children:"Cancel"})]})]})]})})]})},j="",vt=[{id:"verify",label:"Could not verify (WEEX/account)",text:"We could not verify your account / UID."},{id:"criteria",label:"Does not meet criteria",text:"Your application does not meet our current criteria."},{id:"duplicate",label:"Duplicate or invalid request",text:"Duplicate or invalid request."},{id:"other",label:"Other (enter below)",text:""}],ks=()=>{var xt;const x=ls(),c=os(),{fetchWithAdminAuth:n}=et(),b=x.pathname.startsWith("/am")||new URLSearchParams(x.search).get("audience")==="am",[h,f]=u.useState("dashboard"),[C,S]=u.useState(()=>typeof window<"u"&&(window.location.pathname.startsWith("/am")||new URLSearchParams(window.location.search).get("audience")==="am")?"am":"en"),[a,r]=u.useState({total:0,today:0,thisWeek:0,emailsSent:0}),[s,l]=u.useState([]),[d,g]=u.useState([]),[m,N]=u.useState([]),[p,R]=u.useState([]),[k,w]=u.useState([]),[$,O]=u.useState(!0),[P,H]=u.useState(null),[F,U]=u.useState([]),[ae,B]=u.useState([]),[Z,re]=u.useState({}),[J,Y]=u.useState({}),[_,L]=u.useState([]),[le,oe]=u.useState(null),[ie,ce]=u.useState(null),[ue,o]=u.useState(null),[z,ee]=u.useState(null),[X,_e]=u.useState({first_name:"",status:"active",custom_fields_json:"{}"}),[tt,Ae]=u.useState([]),[me,qe]=u.useState({tag_id:0,sequence_id:0}),[De,Te]=u.useState(null),[Ue,Ne]=u.useState(""),[Be,Re]=u.useState("UTC"),[T,st]=u.useState(null),[at,rt]=u.useState([]),[I,K]=u.useState({subject:"",body:"",delay_days:0,delay_hours:0}),[ge,fe]=u.useState(null),[we,Ce]=u.useState(null),[Ot,ze]=u.useState(null),[Je,nt]=u.useState(""),[lt,It]=u.useState("#39FF14"),[q,he]=u.useState({name:"",subject:"",body:"",segment_type:"all",segment_tag_ids:[]}),[ne,de]=u.useState({name:"",subject:"",body:""}),[Se,$e]=u.useState(null),[Qe,ot]=u.useState({name:""}),[it,v]=u.useState(""),[dt,He]=u.useState(""),[ct,Ve]=u.useState(""),[Pe,ke]=u.useState(null),[ye,Me]=u.useState(""),[Ye,Ee]=u.useState(""),[Oe,ut]=u.useState(!1);u.useEffect(()=>{A()},[]),u.useEffect(()=>{b&&C!=="am"?(S("am"),A("am")):!b&&C!=="en"&&(S("en"),A("en"))},[b]),u.useEffect(()=>{h==="analytics"&&qt()},[h]),u.useEffect(()=>{h==="accessRequests"&&n(`${j}/api/access-requests?locale=${C}`).then(t=>t.json()).then(t=>U(Array.isArray(t)?t:[])).catch(()=>U([]))},[h,C]),u.useEffect(()=>{h==="indicatorRequests"&&n(`${j}/api/indicator-access-requests`).then(t=>t.json()).then(t=>B(Array.isArray(t)?t:[])).catch(()=>B([]))},[h]);const Lt=t=>{n(`${j}/api/broadcasts/${t}/analytics`).then(i=>i.json()).then(i=>re(y=>({...y,[t]:i}))).catch(()=>{})},Ft=t=>{n(`${j}/api/sequences/${t}/analytics`).then(i=>i.json()).then(i=>Y(y=>({...y,[t]:i}))).catch(()=>{})};u.useEffect(()=>{h==="settings"&&n(`${j}/api/settings`).then(t=>t.json()).then(t=>{He(t.affiliate_label||""),Ve(t.affiliate_url||"")}).catch(()=>{})},[h]),u.useEffect(()=>{T?Ie(T):(rt([]),Ce(null),fe(null),K({subject:"",body:"",delay_days:0,delay_hours:0}))},[T]),u.useEffect(()=>{h==="sequences"&&n(`${j}/api/sequence-triggers`).then(t=>t.json()).then(t=>Ae(Array.isArray(t)?t:[])).catch(()=>Ae([]))},[h]);const qt=async()=>{try{const t=await n(`${j}/api/analytics`),i=await t.json();t.ok&&i&&i.summary?H(i):H({summary:{totalSent:0,totalOpened:0,totalClicked:0,openRate:0,clickRate:0},byType:[],recentActivity:[]})}catch(t){console.error("Failed to fetch analytics:",t),H({summary:{totalSent:0,totalOpened:0,totalClicked:0,openRate:0,clickRate:0},byType:[],recentActivity:[]})}},Ie=async t=>{try{const y=await(await n(`${j}/api/sequences/${t}/emails`)).json();rt(y)}catch(i){console.error("Failed to fetch sequence emails:",i)}},Dt=async()=>{if(!(!De||!Ue))try{await n(`${j}/api/broadcasts/${De}/schedule`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduled_at:Ue,timezone:Be||"UTC"})}),Te(null),Ne(""),Re("UTC"),v("Broadcast scheduled!"),A()}catch{v("Failed to schedule")}},Ut=async()=>{if(!(!T||!I.subject||!I.body))try{await n(`${j}/api/sequences/${T}/emails`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:I.subject,body:I.body,delay_days:I.delay_days||0,delay_hours:I.delay_hours||0})}),K({subject:"",body:"",delay_days:0,delay_hours:0}),Ie(T),A(),v("Email added to sequence")}catch{v("Failed to add email")}},mt=async t=>{try{await n(`${j}/api/sequences/${t}/activate`,{method:"POST"}),v("Sequence activated"),A()}catch{v("Failed to activate")}},Bt=async t=>{try{await n(`${j}/api/sequences/${t}/pause`,{method:"POST"}),v("Sequence paused"),A()}catch{v("Failed to pause")}},zt=async()=>{if(!(!T||we===null||!we.trim()))try{await n(`${j}/api/sequences/${T}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:we.trim()})}),Ce(null),v("Sequence name updated"),A()}catch{v("Failed to update name")}},ht=async()=>{if(!(!T||!ge))try{await n(`${j}/api/sequences/${T}/emails/${ge}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:I.subject,body:I.body,delay_days:I.delay_days||0,delay_hours:I.delay_hours||0})}),fe(null),K({subject:"",body:"",delay_days:0,delay_hours:0}),v("Step updated"),Ie(T),A()}catch{v("Failed to update step")}},Jt=async(t,i)=>{if(confirm("Remove this step from the sequence?"))try{await n(`${j}/api/sequences/${t}/emails/${i}`,{method:"DELETE"}),ge===i&&(fe(null),K({subject:"",body:"",delay_days:0,delay_hours:0})),v("Step removed"),Ie(t),A()}catch{v("Failed to remove step")}},Qt=async(t,i)=>{try{await n(`${j}/api/subscribers/${t}/sequences/${i}`,{method:"POST"}),v("Subscriber added to sequence"),ze(null),A()}catch{v("Failed to add to sequence")}},Ht=t=>{const i=t.trim().split(/\r?\n/);if(i.length<2)return[];const y=i[0].toLowerCase().split(",").map(W=>W.trim()),M=y.findIndex(W=>W==="email"||W==="e-mail"),V=y.findIndex(W=>W==="first_name"||W==="first name"||W==="firstname"),se=y.findIndex(W=>W==="source");if(M===-1)return[];const xe=[];for(let W=1;W<i.length;W++){const pe=i[W].split(",").map(ns=>ns.trim().replace(/^"|"$/g,"")),We=pe[M]||"";!We||!We.includes("@")||xe.push({email:We,first_name:V>=0&&pe[V]?pe[V]:void 0,source:se>=0&&pe[se]?pe[se]:"import"})}return xe},Vt=async t=>{var V;const i=(V=t.target.files)==null?void 0:V[0];if(!i)return;const y=await i.text(),M=Ht(y);if(M.length===0){v("No valid rows (need email column)"),t.target.value="";return}try{const xe=await(await n(`${j}/api/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscribers:M})})).json();v(`Imported: ${xe.imported}, Skipped: ${xe.skipped}`),t.target.value="",A()}catch{v("Import failed"),t.target.value=""}},A=async t=>{const i=t??C;O(!0);try{const[y,M,V,se,xe,W]=await Promise.all([n(`${j}/api/stats?locale=${i}`),n(`${j}/api/subscribers?locale=${i}`),n(`${j}/api/tags`),n(`${j}/api/templates`),n(`${j}/api/broadcasts`),n(`${j}/api/sequences`)]);r(await y.json());const pe=await M.json();l(pe.subscribers||[]),g(await V.json()),N(await se.json()),R(await xe.json()),w(await W.json())}catch(y){console.error("Failed to fetch:",y)}finally{O(!1)}},Yt=async()=>{Je&&(await n(`${j}/api/tags`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Je,color:lt})}),nt(""),A())},Wt=async t=>{await n(`${j}/api/tags/${t}`,{method:"DELETE"}),A()},Gt=async()=>{!q.subject||!q.body||(await n(`${j}/api/broadcasts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:q.name,subject:q.subject,body:q.body,segment_type:q.segment_type||"all",segment_tag_ids:q.segment_type==="tags"?q.segment_tag_ids:[]})}),he({name:"",subject:"",body:"",segment_type:"all",segment_tag_ids:[]}),v("Broadcast created!"),A())},Xt=async t=>{if(!confirm("Send this broadcast to all subscribers?"))return;v("Sending...");const y=await(await n(`${j}/api/broadcasts/${t}/send`,{method:"POST"})).json();v(`Sent to ${y.sentCount} subscribers`),A()},Kt=async()=>{ne.name&&(await n(`${j}/api/templates`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)}),de({name:"",subject:"",body:""}),A())},Zt=async()=>{Se==null||!ne.name||(await n(`${j}/api/templates/${Se}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)}),$e(null),de({name:"",subject:"",body:""}),A(),v("Template updated"))},es=async t=>{confirm("Delete this template?")&&(await n(`${j}/api/templates/${t}`,{method:"DELETE"}),Se===t&&$e(null),de({name:"",subject:"",body:""}),A(),v("Template deleted"))},ts=async()=>{Qe.name&&(await n(`${j}/api/sequences`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Qe)}),ot({name:""}),A())},ss=async t=>{confirm("Delete this subscriber?")&&(await n(`${j}/api/subscribers/${t}`,{method:"DELETE"}),A())},as=async()=>{if(!z)return;let t={};try{t=JSON.parse(X.custom_fields_json||"{}")}catch{v("Invalid JSON in custom fields");return}try{await n(`${j}/api/subscribers/${z}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:X.first_name,status:X.status,custom_fields:t})}),ee(null),v("Subscriber updated"),A()}catch{v("Failed to update")}},je=t=>new Date(t).toLocaleString(),rs=t=>{const i=new Date(t),y=M=>String(M).padStart(2,"0");return`${i.getFullYear()}-${y(i.getMonth()+1)}-${y(i.getDate())}T${y(i.getHours())}:${y(i.getMinutes())}`},te=({tab:t,icon:i,label:y})=>e.jsxs("button",{onClick:()=>f(t),className:`flex items-center gap-2 px-4 py-3 rounded-lg transition-all duration-300 ${h===t?"bg-primary text-black font-bold shadow-glow-primary-sm border-l-2 border-primary":"text-muted hover:text-foreground hover:bg-surfaceElevated hover:border-l-2 hover:border-primary/30 border-l-2 border-transparent"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:i}),y]});return e.jsxs("div",{className:"min-h-screen bg-background text-foreground flex",children:[e.jsxs("aside",{className:"w-64 bg-surface border-r border-border p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-4 mb-4",children:[e.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"mail"}),e.jsx("span",{className:"font-bold text-xl",children:"Email Marketing"})]}),e.jsx(te,{tab:"dashboard",icon:"dashboard",label:"Dashboard"}),e.jsx(te,{tab:"subscribers",icon:"group",label:"Subscribers"}),e.jsx(te,{tab:"tags",icon:"label",label:"Tags"}),e.jsx(te,{tab:"templates",icon:"article",label:"Templates"}),e.jsx(te,{tab:"broadcasts",icon:"campaign",label:"Broadcasts"}),e.jsx(te,{tab:"sequences",icon:"sync",label:"Sequences"}),e.jsx(te,{tab:"analytics",icon:"analytics",label:"Analytics"}),e.jsx(te,{tab:"accessRequests",icon:"person_add",label:"Access Requests"}),e.jsx(te,{tab:"indicatorRequests",icon:"trending_up",label:"Indicator requests"}),e.jsx(te,{tab:"courses",icon:"school",label:"Courses"}),e.jsx(te,{tab:"settings",icon:"settings",label:"Settings"})]}),e.jsxs("main",{className:"flex-1 p-4 sm:p-6 md:p-8 overflow-auto",children:[it&&e.jsxs("div",{className:"mb-4 p-4 bg-primary/10 text-primary rounded-lg flex justify-between items-center animate-fade-in border border-primary/20",children:[it,e.jsx("button",{onClick:()=>v(""),className:"hover:bg-primary/20 rounded p-1 transition-colors duration-200",children:"×"})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-muted text-sm font-medium",children:"Audience:"}),e.jsxs("div",{className:"flex rounded-lg bg-surfaceElevated border border-border p-0.5",children:[e.jsx("button",{onClick:()=>{S("en"),c("/admin",{replace:!0}),A("en"),h==="accessRequests"&&n(`${j}/api/access-requests?locale=en`).then(t=>t.json()).then(t=>U(Array.isArray(t)?t:[])).catch(()=>U([]))},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${C==="en"?"bg-primary text-black":"text-muted hover:text-foreground"}`,children:"English"}),e.jsx("button",{onClick:()=>{S("am"),c("/am/admin",{replace:!0}),A("am"),h==="accessRequests"&&n(`${j}/api/access-requests?locale=am`).then(t=>t.json()).then(t=>U(Array.isArray(t)?t:[])).catch(()=>U([]))},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${C==="am"?"bg-primary text-black":"text-muted hover:text-foreground"}`,children:"Armenian"})]})]}),h==="dashboard"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("p",{className:"text-muted text-sm",children:"Total Subscribers"}),e.jsx("p",{className:"text-4xl font-bold text-primary mt-2",children:a.total})]}),e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("p",{className:"text-muted text-sm",children:"Today"}),e.jsxs("p",{className:"text-4xl font-bold text-emerald-400 mt-2",children:["+",a.today]})]}),e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("p",{className:"text-muted text-sm",children:"This Week"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-400 mt-2",children:["+",a.thisWeek]})]}),e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("p",{className:"text-muted text-sm",children:"Emails Sent"}),e.jsx("p",{className:"text-4xl font-bold text-purple-400 mt-2",children:a.emailsSent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Subscribers"}),e.jsx("div",{className:"space-y-3",children:s.slice(0,5).map(t=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t.email}),e.jsx("span",{className:"text-muted",children:je(t.created_at)})]},t.id))})]}),e.jsxs("div",{className:"bg-surface rounded-card p-6 border border-border shadow-card hover:shadow-card-hover hover:-translate-y-1 hover:border-primary/20 transition-all duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tags:"})," ",e.jsx("span",{children:d.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Templates:"})," ",e.jsx("span",{children:m.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Broadcasts:"})," ",e.jsx("span",{children:p.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Sequences:"})," ",e.jsx("span",{children:k.length})]})]})]})]})]}),h==="subscribers"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Subscribers (",s.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",accept:".csv",className:"hidden",id:"import-csv-input",onChange:Vt}),e.jsx("label",{htmlFor:"import-csv-input",className:"px-4 py-2 bg-surfaceElevated hover:bg-surface/80 rounded-lg cursor-pointer",children:"Import CSV"}),e.jsx("button",{onClick:A,className:"px-4 py-2 bg-surfaceElevated hover:bg-surface/80 rounded-lg",children:"Refresh"}),e.jsx("a",{href:`${j}/api/export`,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg",children:"Export CSV"})]})]}),_.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-primary/10 rounded-xl border border-primary/20 flex flex-wrap items-center gap-4",children:[e.jsxs("span",{className:"text-primary font-medium",children:[_.length," selected"]}),e.jsxs("select",{value:le??"",onChange:t=>oe(t.target.value?Number(t.target.value):null),className:"bg-background border border-border rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Add tag..."}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),le&&e.jsx("button",{onClick:async()=>{await n(`${j}/api/subscribers/bulk-tag`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriber_ids:_,tag_id:le})}),v("Tag added"),L([]),oe(null),A()},className:"px-3 py-1 bg-primary text-black text-sm font-bold rounded shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Apply"}),e.jsxs("select",{value:ie??"",onChange:t=>ce(t.target.value?Number(t.target.value):null),className:"bg-background border border-border rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Remove tag..."}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),ie&&e.jsx("button",{onClick:async()=>{await n(`${j}/api/subscribers/bulk-remove-tag`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriber_ids:_,tag_id:ie})}),v("Tag removed"),L([]),ce(null),A()},className:"px-3 py-1 bg-amber-500/20 text-amber-400 text-sm rounded",children:"Apply"}),e.jsxs("select",{value:ue??"",onChange:t=>o(t.target.value?Number(t.target.value):null),className:"bg-background border border-border rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Add to sequence..."}),k.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),ue&&e.jsx("button",{onClick:async()=>{await n(`${j}/api/subscribers/bulk-sequence`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriber_ids:_,sequence_id:ue})}),v("Added to sequence"),L([]),o(null),A()},className:"px-3 py-1 bg-blue-500/20 text-blue-400 text-sm rounded",children:"Apply"}),e.jsx("button",{onClick:async()=>{confirm(`Unsubscribe ${_.length} subscriber(s)?`)&&(await n(`${j}/api/subscribers/bulk-unsubscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriber_ids:_})}),v("Unsubscribed"),L([]),A())},className:"px-3 py-1 bg-red-500/20 text-red-400 text-sm rounded",children:"Unsubscribe"}),e.jsx("button",{onClick:()=>{L([]),oe(null),ce(null),o(null)},className:"text-muted text-sm",children:"Clear"})]}),e.jsx("div",{className:"bg-surface rounded-xl border border-border overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceElevated",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs text-muted",children:e.jsx("input",{type:"checkbox",checked:s.length>0&&_.length===s.length,onChange:t=>L(t.target.checked?s.map(i=>i.id):[]),className:"rounded"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"Tags"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs text-muted",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:s.map((t,i)=>{var y;return e.jsxs("tr",{className:"hover:bg-surfaceElevated",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:_.includes(t.id),onChange:M=>L(M.target.checked?[..._,t.id]:_.filter(V=>V!==t.id)),className:"rounded"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted",children:i+1}),e.jsx("td",{className:"px-6 py-4 text-sm font-mono",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded text-xs",children:t.source})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("div",{className:"flex gap-1 flex-wrap",children:(y=t.tags)==null?void 0:y.map(M=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs",style:{background:M.color+"20",color:M.color},children:M.name},M.id))})}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted",children:je(t.created_at)}),e.jsxs("td",{className:"px-6 py-4 text-sm",children:[e.jsx("button",{onClick:()=>{ee(t.id),_e({first_name:t.first_name||"",status:t.status,custom_fields_json:JSON.stringify(t.custom_fields||{},null,2)})},className:"text-primary hover:underline mr-2",children:"Edit"}),e.jsx("button",{onClick:()=>ss(t.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},t.id)})})]})}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface rounded-xl border border-border p-6 max-w-md w-full",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Edit subscriber"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-1",children:"First name"}),e.jsx("input",{value:X.first_name,onChange:t=>_e({...X,first_name:t.target.value}),className:"w-full bg-background border border-border rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-1",children:"Status"}),e.jsxs("select",{value:X.status,onChange:t=>_e({...X,status:t.target.value}),className:"w-full bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"unsubscribed",children:"unsubscribed"}),e.jsx("option",{value:"pending",children:"pending"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-1",children:"Custom fields (JSON)"}),e.jsx("textarea",{value:X.custom_fields_json,onChange:t=>_e({...X,custom_fields_json:t.target.value}),rows:4,className:"w-full bg-background border border-border rounded-lg px-4 py-2 font-mono text-sm",placeholder:'{"company": "Acme", "phone": "123"}'})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:as,className:"px-4 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Save"}),e.jsx("button",{onClick:()=>ee(null),className:"px-4 py-2 bg-white/10 rounded-lg",children:"Cancel"})]})]})]})})]}),h==="tags"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Tags"}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Create New Tag"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:Je,onChange:t=>nt(t.target.value),placeholder:"Tag name",className:"flex-1 bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("input",{type:"color",value:lt,onChange:t=>It(t.target.value),className:"w-12 h-10 rounded cursor-pointer"}),e.jsx("button",{onClick:Yt,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Create"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:d.map(t=>e.jsxs("div",{className:"bg-surface rounded-xl p-4 border border-border flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{background:t.color}}),e.jsx("span",{children:t.name})]}),e.jsx("button",{onClick:()=>Wt(t.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]},t.id))})]}),h==="templates"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Email Templates"}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:Se?"Edit Template":"Create New Template"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:ne.name,onChange:t=>de({...ne,name:t.target.value}),placeholder:"Template name",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("input",{type:"text",value:ne.subject,onChange:t=>de({...ne,subject:t.target.value}),placeholder:"Email subject",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("textarea",{value:ne.body,onChange:t=>de({...ne,body:t.target.value}),placeholder:"Email body (HTML supported)",rows:6,className:"w-full bg-background border border-border rounded-lg px-4 py-2 font-mono text-sm"}),Se?e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Zt,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Update Template"}),e.jsx("button",{onClick:()=>{$e(null),de({name:"",subject:"",body:""})},className:"px-6 py-2 bg-surfaceElevated border border-border rounded-lg text-foreground",children:"Cancel"})]}):e.jsx("button",{onClick:Kt,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Save Template"})]})]}),e.jsx("div",{className:"space-y-4",children:m.map(t=>e.jsx("div",{className:"bg-surface rounded-xl p-6 border border-border",children:e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-muted text-sm",children:["Subject: ",t.subject]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{$e(t.id),de({name:t.name,subject:t.subject,body:t.body||""})},className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-sm font-semibold hover:bg-primary/30 transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>es(t.id),className:"px-4 py-2 bg-rose-500/20 text-rose-400 rounded-lg text-sm font-semibold hover:bg-rose-500/30 transition-colors",children:"Delete"})]})]})},t.id))})]}),h==="broadcasts"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Broadcasts"}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Create New Broadcast"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-1",children:"Pick template (optional)"}),e.jsxs("select",{value:"",onChange:t=>{const i=t.target.value?Number(t.target.value):0,y=m.find(M=>M.id===i);y&&he({...q,subject:y.subject,body:y.body||""}),t.target.value=""},className:"bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"",children:"-- Choose template --"}),m.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("input",{type:"text",value:q.name,onChange:t=>he({...q,name:t.target.value}),placeholder:"Broadcast name (internal)",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("input",{type:"text",value:q.subject,onChange:t=>he({...q,subject:t.target.value}),placeholder:"Email subject",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("textarea",{value:q.body,onChange:t=>he({...q,body:t.target.value}),placeholder:"Email body (HTML supported). Use {{first_name}}, {{email}}, {{unsubscribe_url}}",rows:8,className:"w-full bg-background border border-border rounded-lg px-4 py-2 font-mono text-sm"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-2",children:"Send to"}),e.jsxs("select",{value:q.segment_type,onChange:t=>he({...q,segment_type:t.target.value}),className:"bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"all",children:"All active subscribers"}),e.jsx("option",{value:"tags",children:"Subscribers with tag(s)"})]}),q.segment_type==="tags"&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[d.map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:q.segment_tag_ids.includes(t.id),onChange:i=>{const y=i.target.checked?[...q.segment_tag_ids,t.id]:q.segment_tag_ids.filter(M=>M!==t.id);he({...q,segment_tag_ids:y})},className:"rounded"}),e.jsx("span",{className:"text-sm",style:{color:t.color},children:t.name})]},t.id)),d.length===0&&e.jsx("span",{className:"text-muted text-sm",children:"No tags. Create tags in Tags tab."})]})]}),e.jsx("button",{onClick:Gt,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Create Broadcast"})]})]}),De&&e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-primary/30 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"When to send"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"Schedule broadcast — choose date, time and timezone."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("input",{type:"datetime-local",value:Ue,onChange:t=>Ne(t.target.value),className:"bg-background border border-border rounded-lg px-4 py-2"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-xs mb-1",children:"Timezone"}),e.jsxs("select",{value:Be,onChange:t=>Re(t.target.value),className:"bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"Europe/London",children:"Europe/London"}),e.jsx("option",{value:"Europe/Paris",children:"Europe/Paris"}),e.jsx("option",{value:"Europe/Yerevan",children:"Europe/Yerevan"}),e.jsx("option",{value:"America/New_York",children:"America/New_York"}),e.jsx("option",{value:"America/Los_Angeles",children:"America/Los_Angeles"}),e.jsx("option",{value:"Asia/Dubai",children:"Asia/Dubai"}),e.jsx("option",{value:"Asia/Tokyo",children:"Asia/Tokyo"})]})]}),e.jsx("button",{onClick:Dt,className:"px-4 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Schedule"}),e.jsx("button",{onClick:()=>{Te(null),Ne(""),Re("UTC")},className:"px-4 py-2 bg-white/10 rounded-lg",children:"Cancel"})]})]}),e.jsx("div",{className:"space-y-4",children:p.map(t=>e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:t.name||t.subject}),e.jsxs("p",{className:"text-muted text-sm mt-1",children:["Subject: ",t.subject]}),t.status==="scheduled"&&t.scheduled_at&&e.jsxs("p",{className:"text-sm text-blue-400 mt-1",children:["Scheduled: ",je(t.scheduled_at)]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`px-3 py-1 rounded text-xs ${t.status==="sent"?"bg-emerald-500/20 text-emerald-400":t.status==="scheduled"?"bg-blue-500/20 text-blue-400":"bg-gray-500/20 text-muted"}`,children:t.status}),t.status==="scheduled"&&t.scheduled_at&&e.jsx("button",{onClick:()=>{Te(t.id),Ne(rs(t.scheduled_at)),Re(Be)},className:"px-4 py-2 bg-blue-500/20 text-blue-400 rounded-lg text-sm",children:"Change schedule"}),t.status==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Xt(t.id),className:"px-4 py-2 bg-primary text-black font-bold rounded-lg text-sm shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Send Now"}),e.jsx("button",{onClick:()=>{const i=prompt("Subject B (for A/B test):");i!=null&&i.trim()&&n(`${j}/api/broadcasts/${t.id}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ab_test:!0,subject_b:i.trim()})}).then(y=>y.json()).then(y=>{v(y.abTest||y.error||"Sent"),A()})},className:"px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg text-sm",children:"A/B test"}),e.jsx("button",{onClick:()=>{Te(t.id),Ne("")},className:"px-4 py-2 bg-blue-500/20 text-blue-400 rounded-lg text-sm",children:"Schedule"}),e.jsx("button",{onClick:async()=>{try{const i=await n(`${j}/api/broadcasts/${t.id}/test-send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),y=await i.json().catch(()=>({}));v(i.ok?y.message||"Test email sent":y.error||"Failed")}catch{v("Failed to send test")}},className:"px-4 py-2 bg-amber-500/20 text-amber-400 rounded-lg text-sm",children:"Send test"})]})]})]}),t.sent_count>0&&e.jsxs("p",{className:"text-sm text-muted mt-2",children:["Sent: ",t.sent_count," | Failed: ",t.failed_count]}),t.status==="sent"&&e.jsx("div",{className:"mt-2",children:Z[t.id]?e.jsxs("p",{className:"text-sm text-muted",children:["Opened: ",Z[t.id].opened," (",Z[t.id].openRate,"%) | Clicked: ",Z[t.id].clicked," (",Z[t.id].clickRate,"%)"]}):e.jsx("button",{type:"button",onClick:()=>Lt(t.id),className:"text-xs text-primary hover:underline",children:"Load stats"})})]},t.id))})]}),h==="sequences"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted text-sm mb-6",children:"1) Create sequence → 2) Add emails with delay → 3) Set triggers (tag → sequence) or add subscribers → 4) Activate."}),!T&&e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Triggers: when a subscriber gets a tag, add them to a sequence"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsxs("select",{value:me.tag_id||"",onChange:t=>qe({...me,tag_id:Number(t.target.value)}),className:"bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"",children:"Select tag"}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:me.sequence_id||"",onChange:t=>qe({...me,sequence_id:Number(t.target.value)}),className:"bg-background border border-border rounded-lg px-4 py-2",children:[e.jsx("option",{value:"",children:"Select sequence"}),k.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{onClick:async()=>{!me.tag_id||!me.sequence_id||(await n(`${j}/api/sequence-triggers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)}),v("Trigger added"),qe({tag_id:0,sequence_id:0}),n(`${j}/api/sequence-triggers`).then(t=>t.json()).then(t=>Ae(Array.isArray(t)?t:[])))},className:"px-4 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Add trigger"})]}),e.jsxs("div",{className:"space-y-2",children:[tt.map(t=>{var i;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border",children:[e.jsxs("span",{children:["When tag ",e.jsx("strong",{style:{color:((i=d.find(y=>y.id===t.tag_id))==null?void 0:i.color)||"#fff"},children:t.tag_name})," is added → add to sequence ",e.jsx("strong",{children:t.sequence_name})]}),e.jsx("button",{onClick:async()=>{await n(`${j}/api/sequence-triggers/${t.id}`,{method:"DELETE"}),Ae(y=>y.filter(M=>M.id!==t.id)),v("Trigger removed")},className:"text-red-400 hover:underline text-sm",children:"Remove"})]},t.id)}),tt.length===0&&e.jsx("p",{className:"text-muted text-sm",children:"No triggers. Add one above."})]})]}),T?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 flex-wrap",children:[e.jsxs("button",{onClick:()=>st(null),className:"flex items-center gap-2 text-muted hover:text-foreground",children:[e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})," Back to list"]}),J[T]?e.jsxs("span",{className:"text-sm text-muted",children:["Sequence stats: Sent ",J[T].sent," | Opened ",J[T].opened," (",J[T].openRate,"%) | Clicked ",J[T].clicked," (",J[T].clickRate,"%)"]}):e.jsx("button",{type:"button",onClick:()=>Ft(T),className:"text-sm text-primary hover:underline",children:"Load sequence stats"})]}),(()=>{const t=k.find(i=>i.id===T);return t?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 flex-wrap mb-2",children:we===null?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold",children:t.name}),e.jsx("button",{onClick:()=>Ce(t.name),className:"px-3 py-1.5 bg-surfaceElevated hover:bg-white/10 rounded-lg text-sm text-muted hover:text-foreground",children:"Edit name"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:we,onChange:i=>Ce(i.target.value),className:"bg-background border border-border rounded-lg px-4 py-2 text-xl font-bold flex-1 min-w-[200px]"}),e.jsx("button",{onClick:zt,className:"px-4 py-2 bg-primary text-black font-bold rounded-lg text-sm",children:"Save"}),e.jsx("button",{onClick:()=>Ce(null),className:"px-4 py-2 bg-white/10 rounded-lg text-sm",children:"Cancel"})]})}),e.jsxs("p",{className:"text-muted text-sm mb-6",children:[t.email_count," emails • ",t.subscriber_count," subscribers • ",t.status]}),e.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[t.status==="draft"&&e.jsx("button",{onClick:()=>mt(T),className:"px-6 py-2 bg-emerald-500/20 text-emerald-400 rounded-lg font-semibold",children:"Activate Sequence"}),t.status==="active"&&e.jsx("button",{onClick:()=>Bt(T),className:"px-6 py-2 bg-amber-500/20 text-amber-400 rounded-lg font-semibold",children:"Pause"}),t.status==="paused"&&e.jsx("button",{onClick:()=>mt(T),className:"px-6 py-2 bg-emerald-500/20 text-emerald-400 rounded-lg font-semibold",children:"Activate"})]}),t.status==="draft"&&e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:ge?"Edit Step":"Add Email to Sequence"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:I.subject,onChange:i=>K({...I,subject:i.target.value}),placeholder:"Subject",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("textarea",{value:I.body,onChange:i=>K({...I,body:i.target.value}),placeholder:"Body (HTML)",rows:4,className:"w-full bg-background border border-border rounded-lg px-4 py-2 font-mono text-sm"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted text-sm",children:"Delay days"}),e.jsx("input",{type:"number",min:0,value:I.delay_days,onChange:i=>K({...I,delay_days:parseInt(i.target.value)||0}),className:"w-20 bg-background border border-border rounded-lg px-2 py-1 text-sm"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted text-sm",children:"Delay hours"}),e.jsx("input",{type:"number",min:0,value:I.delay_hours,onChange:i=>K({...I,delay_hours:parseInt(i.target.value)||0}),className:"w-20 bg-background border border-border rounded-lg px-2 py-1 text-sm"})]})]}),ge?e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ht,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm",children:"Update Step"}),e.jsx("button",{onClick:()=>{fe(null),K({subject:"",body:"",delay_days:0,delay_hours:0})},className:"px-6 py-2 bg-white/10 rounded-lg",children:"Cancel"})]}):e.jsx("button",{onClick:Ut,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Add Email"})]})]}),ge!=null&&t.status!=="draft"&&e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-primary/30 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Edit Step"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:I.subject,onChange:i=>K({...I,subject:i.target.value}),placeholder:"Subject",className:"w-full bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("textarea",{value:I.body,onChange:i=>K({...I,body:i.target.value}),placeholder:"Body (HTML)",rows:4,className:"w-full bg-background border border-border rounded-lg px-4 py-2 font-mono text-sm"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted text-sm",children:"Delay days"}),e.jsx("input",{type:"number",min:0,value:I.delay_days,onChange:i=>K({...I,delay_days:parseInt(i.target.value)||0}),className:"w-20 bg-background border border-border rounded-lg px-2 py-1 text-sm"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted text-sm",children:"Delay hours"}),e.jsx("input",{type:"number",min:0,value:I.delay_hours,onChange:i=>K({...I,delay_hours:parseInt(i.target.value)||0}),className:"w-20 bg-background border border-border rounded-lg px-2 py-1 text-sm"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ht,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm",children:"Update Step"}),e.jsx("button",{onClick:()=>{fe(null),K({subject:"",body:"",delay_days:0,delay_hours:0})},className:"px-6 py-2 bg-white/10 rounded-lg",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Sequence Emails"}),at.length===0?e.jsx("p",{className:"text-muted text-sm",children:"No emails yet. Add emails above (draft only)."}):e.jsx("div",{className:"space-y-3",children:at.map(i=>e.jsxs("div",{className:"flex justify-between items-start py-3 border-b border-border last:border-0",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted text-sm mr-2",children:["#",i.position]}),e.jsx("span",{className:"font-medium",children:i.subject}),e.jsxs("p",{className:"text-muted text-xs mt-1",children:["Delay: ",i.delay_days,"d ",i.delay_hours,"h"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{fe(i.id),K({subject:i.subject,body:i.body,delay_days:i.delay_days,delay_hours:i.delay_hours})},className:"px-3 py-1.5 bg-primary/20 text-primary rounded text-sm hover:bg-primary/30",children:"Edit"}),e.jsx("button",{onClick:()=>Jt(T,i.id),className:"px-3 py-1.5 bg-rose-500/20 text-rose-400 rounded text-sm hover:bg-rose-500/30",children:"Delete"})]})]},i.id))})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Add Subscribers to Sequence"}),Ot===T?e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[s.map(i=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[e.jsx("span",{className:"font-mono text-sm",children:i.email}),e.jsx("button",{onClick:()=>Qt(i.id,T),className:"px-3 py-1 bg-primary/20 text-primary rounded text-sm",children:"Add"})]},i.id)),e.jsx("button",{onClick:()=>ze(null),className:"text-muted hover:text-foreground text-sm mt-2",children:"Cancel"})]}):e.jsx("button",{onClick:()=>ze(T),className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-sm",children:"Choose subscribers to add"})]})]}):e.jsx("p",{className:"text-muted",children:"Sequence not found."})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Email Sequences"}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Create New Sequence"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:Qe.name,onChange:t=>ot({name:t.target.value}),placeholder:"Sequence name",className:"flex-1 bg-background border border-border rounded-lg px-4 py-2"}),e.jsx("button",{onClick:ts,className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Create"})]})]}),e.jsx("div",{className:"space-y-4",children:k.map(t=>e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:t.name}),e.jsxs("p",{className:"text-muted text-sm mt-1",children:[t.email_count," emails • ",t.subscriber_count," subscribers"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded text-xs ${t.status==="active"?"bg-emerald-500/20 text-emerald-400":t.status==="paused"?"bg-amber-500/20 text-amber-400":"bg-gray-500/20 text-muted"}`,children:t.status}),e.jsx("button",{onClick:()=>st(t.id),className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-sm",children:"Manage"})]})]},t.id))})]})]}),h==="analytics"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Email Analytics"}),P?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("p",{className:"text-muted text-sm",children:"Emails Sent"}),e.jsx("p",{className:"text-4xl font-bold text-primary mt-2",children:P.summary.totalSent})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("p",{className:"text-muted text-sm",children:"Opened"}),e.jsx("p",{className:"text-4xl font-bold text-emerald-400 mt-2",children:P.summary.totalOpened})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("p",{className:"text-muted text-sm",children:"Clicked"}),e.jsx("p",{className:"text-4xl font-bold text-blue-400 mt-2",children:P.summary.totalClicked})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("p",{className:"text-muted text-sm",children:"Open Rate"}),e.jsxs("p",{className:"text-4xl font-bold text-purple-400 mt-2",children:[P.summary.openRate,"%"]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("p",{className:"text-muted text-sm",children:"Click Rate"}),e.jsxs("p",{className:"text-4xl font-bold text-amber-400 mt-2",children:[P.summary.clickRate,"%"]})]})]}),P.byType&&P.byType.length>0&&e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"By Email Type"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left text-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-2",children:"Type"}),e.jsx("th",{className:"pb-2",children:"Total"}),e.jsx("th",{className:"pb-2",children:"Opened"}),e.jsx("th",{className:"pb-2",children:"Clicked"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:P.byType.map((t,i)=>e.jsxs("tr",{className:"hover:bg-surfaceElevated transition-colors duration-200",children:[e.jsx("td",{className:"py-2",children:t.email_type||"—"}),e.jsx("td",{className:"py-2",children:t.total}),e.jsx("td",{className:"py-2",children:t.opened}),e.jsx("td",{className:"py-2",children:t.clicked})]},i))})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),e.jsx("div",{className:"space-y-2",children:(xt=P.recentActivity)!=null&&xt.length?P.recentActivity.map(t=>e.jsxs("div",{className:"flex justify-between items-center text-sm py-2 border-b border-border last:border-0",children:[e.jsx("span",{className:"font-mono",children:t.email}),e.jsx("span",{className:"text-muted",children:t.email_type}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${t.status==="clicked"?"bg-blue-500/20 text-blue-400":"bg-emerald-500/20 text-emerald-400"}`,children:t.status}),e.jsx("span",{className:"text-muted",children:je(t.sent_at)})]},t.id)):e.jsx("p",{className:"text-muted text-sm",children:"No recent activity"})})]})]}):e.jsx("p",{className:"text-muted",children:"Loading analytics..."})]}),h==="accessRequests"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Access Requests"}),e.jsxs("div",{className:"bg-surface rounded-xl border border-border overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-surfaceElevated",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"UID"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Locale"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Created"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:F.map(t=>e.jsxs("tr",{className:"border-t border-border hover:bg-surfaceElevated transition-colors duration-200",children:[e.jsx("td",{className:"px-4 py-3",children:t.email}),e.jsx("td",{className:"px-4 py-3 font-mono",children:t.uid}),e.jsx("td",{className:"px-4 py-3 text-muted text-sm",children:t.locale||"en"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="pending"?"bg-amber-500/20 text-amber-400":t.status==="accepted"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-muted text-sm",children:je(t.created_at)}),e.jsx("td",{className:"px-4 py-3",children:t.status==="pending"&&e.jsxs("span",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{await n(`${j}/api/access-requests/${t.id}/accept`,{method:"POST"}),v("Request accepted. User will receive set-password email."),n(`${j}/api/access-requests?locale=${C}`).then(i=>i.json()).then(i=>U(Array.isArray(i)?i:[]))}catch{v("Failed to accept")}},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30",children:"Accept"}),e.jsx("button",{onClick:()=>{ke({type:"access",id:t.id}),Me(""),Ee("")},className:"px-3 py-1 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30",children:"Reject"})]})})]},t.id))})]}),F.length===0&&e.jsx("p",{className:"p-6 text-muted text-center",children:"No access requests"})]})]}),h==="indicatorRequests"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Indicator requests"}),e.jsxs("div",{className:"bg-surface rounded-xl border border-border overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-surfaceElevated",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"TradingView username"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Requested at"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-muted font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:ae.map(t=>e.jsxs("tr",{className:"border-t border-border hover:bg-surfaceElevated transition-colors duration-200",children:[e.jsx("td",{className:"px-4 py-3",children:t.email}),e.jsx("td",{className:"px-4 py-3",children:t.first_name||"—"}),e.jsx("td",{className:"px-4 py-3 font-mono",children:t.tradingview_username||"—"}),e.jsx("td",{className:"px-4 py-3 text-muted text-sm",children:t.indicator_requested_at?je(t.indicator_requested_at):"—"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.indicator_access_status==="pending"?"bg-amber-500/20 text-amber-400":t.indicator_access_status==="approved"?"bg-green-500/20 text-green-400":t.indicator_access_status==="rejected"?"bg-red-500/20 text-red-400":"bg-muted/20 text-muted"}`,children:t.indicator_access_status})}),e.jsx("td",{className:"px-4 py-3",children:t.indicator_access_status==="pending"&&e.jsxs("span",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{const i=await n(`${j}/api/indicator-access-requests/${t.id}/approve`,{method:"POST"});if(!i.ok){const V=await i.json().catch(()=>({}));v(V.error||"Failed to approve");return}v("Access approved. User will receive an email.");const M=await(await n(`${j}/api/indicator-access-requests`)).json();B(Array.isArray(M)?M:[])}catch{v("Failed to approve")}},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30",children:"Approve"}),e.jsx("button",{onClick:()=>{ke({type:"indicator",userId:t.id}),Me(""),Ee("")},className:"px-3 py-1 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30",children:"Reject"})]})})]},t.id))})]}),ae.length===0&&e.jsx("p",{className:"p-6 text-muted text-center",children:"No indicator access requests"})]})]}),h==="courses"&&e.jsx(Ss,{setMessage:v}),h==="settings"&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Affiliate Link (Access page)"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"This text and link appear at the top of the Access page and below the Register Now button. Use your Wix affiliate link."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-2",children:"Label (visible text)"}),e.jsx("input",{type:"text",value:dt,onChange:t=>He(t.target.value),placeholder:"e.g. Test Affiliate Link",className:"w-full bg-background border border-border rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-muted text-sm mb-2",children:"URL (affiliate link)"}),e.jsx("input",{type:"text",value:ct,onChange:t=>Ve(t.target.value),placeholder:"hayktrading.am or https://...",className:"w-full bg-background border border-border rounded-lg px-4 py-2"})]}),e.jsx("button",{onClick:async()=>{try{const t=await n(`${j}/api/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({affiliate_label:dt,affiliate_url:ct})});if(t.ok){const i=await t.json();v("Affiliate settings saved. Open or refresh the Access page to see the new text."),He(i.affiliate_label??""),Ve(i.affiliate_url??"")}else v("Failed to save")}catch{v("Failed to save")}},className:"px-6 py-2 bg-primary text-black font-bold rounded-lg shadow-glow-primary-sm hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98] transition-all duration-300",children:"Save Affiliate Link"})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"SMTP Configuration"}),e.jsxs("p",{className:"text-muted text-sm mb-4",children:["Configure in ",e.jsx("code",{className:"text-primary",children:"server/.env"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"Server:"})," mail.privateemail.com"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"Port:"})," 465"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"From:"})," info@superengulfing.com"]})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Database"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"Type:"})," PostgreSQL"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"Database:"})," superengulfing_email"]})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Test Email"}),e.jsx("button",{onClick:async()=>{const i=await(await n(`${j}/api/test-email`)).json();v(i.success?"✅ Test email sent!":"❌ Failed")},className:"px-6 py-2 bg-primary/20 text-primary rounded-lg",children:"Send Test Email"})]})]})]})]}),Pe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:()=>!Oe&&ke(null),children:e.jsxs("div",{className:"bg-surface border border-border rounded-xl shadow-xl max-w-md w-full p-6",onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Reject request – reason"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"Choose a reason or enter your own. The user will receive an email with this reason."}),e.jsx("div",{className:"space-y-2 mb-4",children:vt.map(t=>e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"rejectReason",checked:ye===t.id,onChange:()=>{Me(t.id),t.id!=="other"&&Ee("")},className:"mt-1"}),e.jsx("span",{className:"text-sm",children:t.label})]},t.id))}),ye==="other"&&e.jsx("textarea",{value:Ye,onChange:t=>Ee(t.target.value),placeholder:"Enter reason...",className:"w-full h-24 bg-background border border-border rounded-lg px-4 py-2 text-sm mb-4 resize-none"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>ke(null),disabled:Oe,className:"px-4 py-2 rounded-lg border border-border hover:bg-surfaceElevated disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"button",disabled:Oe||!ye||ye==="other"&&!Ye.trim(),onClick:async()=>{var i;const t=ye==="other"?Ye.trim():((i=vt.find(y=>y.id===ye))==null?void 0:i.text)??"";if(t){ut(!0);try{if(Pe.type==="access"){const y=await n(`${j}/api/access-requests/${Pe.id}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:t})});if(!y.ok){const se=await y.json().catch(()=>({}));v(se.error||"Failed to reject");return}v("Request rejected. User will receive an email with the reason.");const V=await(await n(`${j}/api/access-requests?locale=${C}`)).json();U(Array.isArray(V)?V:[])}else{const y=await n(`${j}/api/indicator-access-requests/${Pe.userId}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:t})});if(!y.ok){const se=await y.json().catch(()=>({}));v(se.error||"Failed to reject");return}v("Request rejected. User will receive an email with the reason.");const V=await(await n(`${j}/api/indicator-access-requests`)).json();B(Array.isArray(V)?V:[])}ke(null),Me(""),Ee("")}catch{v("Failed to reject")}finally{ut(!1)}}},className:"px-4 py-2 rounded-lg bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 disabled:opacity-50 disabled:cursor-not-allowed",children:Oe?"Sending...":"Reject and send email"})]})]})})]})},Es=[{value:"1h",label:"1 hour"},{value:"3h",label:"3 hours"},{value:"12h",label:"12 hours"},{value:"1d",label:"1 day"},{value:"2d",label:"2 days"},{value:"1w",label:"1 week"}];function Fs(){const{isValid:x,requestCode:c,verify:n}=et(),[b,h]=u.useState(1),[f,C]=u.useState(""),[S,a]=u.useState(""),[r,s]=u.useState(""),[l,d]=u.useState(!1),[g,m]=u.useState(""),[N,p]=u.useState(""),[R,k]=u.useState(!1),[w,$]=u.useState("1d"),[O,P]=u.useState(""),[H,F]=u.useState(!1),U=async _=>{_.preventDefault(),P(""),F(!0);try{const L=await c(f);L.success?(a(f.trim().toLowerCase()),s(L.emailMasked||"***"),d(!!L.setupRequired),m(L.otpauthUrl||""),h(2),p("")):P(L.error||"Invalid secret password")}finally{F(!1)}},ae=async _=>{_.preventDefault(),P(""),F(!0);try{const L=await n(S,N,R,w);L.success?(h(1),C(""),a(""),p("")):P(L.error||"Invalid or expired code")}finally{F(!1)}};if(x)return e.jsx(ks,{});const B="min-h-screen bg-background text-foreground flex items-center justify-center p-4",Z="w-full max-w-md bg-surface border border-border rounded-card p-8 shadow-card",re="w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:ring-2 focus:ring-primary focus:border-primary outline-none",J="w-full py-3 rounded-lg font-medium bg-primary text-black hover:opacity-90 transition-opacity disabled:opacity-50",Y="block text-sm font-medium text-muted mb-2";return e.jsx("div",{className:B,children:e.jsxs("div",{className:Z,children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Admin panel"}),b===1&&e.jsxs("form",{onSubmit:U,children:[e.jsx("label",{className:Y,children:"Secret password"}),e.jsx("input",{type:"password",value:f,onChange:_=>{C(_.target.value),P("")},className:re,placeholder:"Enter secret password",autoComplete:"off",autoFocus:!0}),O&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:O}),e.jsx("button",{type:"submit",className:`${J} mt-6`,disabled:H||!f.trim(),children:H?"Checking…":"Continue"})]}),b===2&&e.jsxs("form",{onSubmit:ae,children:[l?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Set up Google Authenticator"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"Scan this QR code with Google Authenticator (or similar app), then enter the 6-digit code below."}),g&&e.jsx("div",{className:"flex justify-center my-6",children:e.jsx(Mt,{value:g,size:200,level:"M"})})]}):e.jsx("p",{className:"text-muted text-sm mb-4",children:"Enter the 6-digit code from your authenticator app."}),e.jsx("label",{className:Y,children:"Authenticator code"}),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,value:N,onChange:_=>{p(_.target.value.replace(/\D/g,"")),P("")},className:re,placeholder:"000000",autoComplete:"one-time-code",autoFocus:!0}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"remember",checked:R,onChange:_=>k(_.target.checked),className:"rounded border-border"}),e.jsx("label",{htmlFor:"remember",className:"text-sm text-muted",children:"Remember me"})]}),R&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:Y,children:"Duration"}),e.jsx("select",{value:w,onChange:_=>$(_.target.value),className:re,children:Es.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))})]}),O&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:O}),e.jsx("button",{type:"submit",className:`${J} mt-6`,disabled:H||!N.trim(),children:H?"Verifying…":"Sign in"}),e.jsx("button",{type:"button",onClick:()=>{h(1),P(""),p(""),a(""),d(!1),m("")},className:"w-full py-2 mt-3 text-sm text-muted hover:text-foreground",children:"Back to password"})]})]})})}export{Os as A,Fs as a};
